<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <button onclick="lstUsers()">listUsers</button>
    <table>
        <tr>
            <td>
                name
            </td>
            <td>
                email
            </td>
            <tbody class="part1">

            </tbody>
        </tr>
    </table>
</body>
<script>
    // function lstUsers(){    
    //     // we have  to  create xmlhttp reqst obj
    //     var request = new XMLHttpRequest()
    //     //WE open(method,url)
    //     request.open("get", "https://jsonplaceholder.typicode.com/users")
    //     request.send()
    //     request.onreadystatechange = () => {
    //         if (request.readyState == 4) {
    //             if ((request.status > 199) & (request.status < 300)) {
    //                 console.log(request.responseText)
    //                 var data = JSON.parse(request.responseText)
    //                 //data.forEach(element =>console.log(element.name + element.username));
    //                 var html_data = ""
    //                 data.forEach(obj => {
    //                     html_data += `<tr><td>${obj.name}</td><td>${obj.email}</td></tr>`
    //                 })

    //                 document.querySelector(".part1").innerHTML = html_data
    //             }

    //        }
    //     }
    // }
    //promises-request koduthit athinte  response store chaiyuna aa primses, sucess ya failure

    function populate(data) {
        var html_data = ""
        data.forEach(obj => {
            html_data += `<tr><td>${obj.name}</td><td>${obj.email}</td></tr>`
        })

        document.querySelector(".part1").innerHTML = html_data
    }



    function lstUsers() {
        //fetch(url),default method-get
        fetch("https://jsonplaceholder.typicode.com/usersss")// return promise
            .then(response => {
                console.log(response.status)
                if(!response.ok){
                    throw new Error(`failed ${response.status}`)
                }
                            
            return response.json()})
            .then(data => populate(data))
            .catch(err=>alert(err)) // exception handling -  url wrong
    }

</script>

</html>